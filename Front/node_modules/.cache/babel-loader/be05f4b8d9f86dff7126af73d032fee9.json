{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst react_1 = __importDefault(require(\"react\"));\n\nconst library_1 = require(\"@zxing/library\");\n\nconst react_webcam_1 = __importDefault(require(\"react-webcam\"));\n\nconst BarcodeScannerComponent = _ref => {\n  let {\n    onUpdate,\n    onError,\n    width = \"100%\",\n    height = \"100%\",\n    facingMode = \"environment\",\n    torch,\n    delay = 500,\n    videoConstraints,\n    stopStream\n  } = _ref;\n  const webcamRef = react_1.default.useRef(null);\n  const capture = react_1.default.useCallback(() => {\n    var _a;\n\n    const codeReader = new library_1.BrowserMultiFormatReader();\n    const imageSrc = (_a = webcamRef === null || webcamRef === void 0 ? void 0 : webcamRef.current) === null || _a === void 0 ? void 0 : _a.getScreenshot();\n\n    if (imageSrc) {\n      codeReader.decodeFromImage(undefined, imageSrc).then(result => {\n        onUpdate(null, result);\n      }).catch(err => {\n        onUpdate(err);\n      });\n    }\n  }, [onUpdate]);\n  react_1.default.useEffect(() => {\n    var _a, _b; // Turn on the flashlight if prop is defined and device has the capability\n\n\n    if (typeof torch === \"boolean\" && ((_a = // @ts-ignore\n    navigator === null || // @ts-ignore\n    navigator === void 0 ? void 0 : // @ts-ignore\n    navigator.mediaDevices) === null || _a === void 0 ? void 0 : _a.getSupportedConstraints().torch)) {\n      const stream = (_b = webcamRef === null || webcamRef === void 0 ? void 0 : webcamRef.current) === null || _b === void 0 ? void 0 : _b.video.srcObject;\n      const track = stream === null || stream === void 0 ? void 0 : stream.getVideoTracks()[0]; // get the active track of the stream\n\n      if (track && track.getCapabilities().torch && !track.getConstraints().torch) {\n        track.applyConstraints({\n          advanced: [{\n            torch\n          }]\n        }).catch(err => onUpdate(err));\n      }\n    }\n  }, [torch, onUpdate]);\n  react_1.default.useEffect(() => {\n    var _a;\n\n    if (stopStream) {\n      let stream = (_a = webcamRef === null || webcamRef === void 0 ? void 0 : webcamRef.current) === null || _a === void 0 ? void 0 : _a.video.srcObject;\n\n      if (stream) {\n        stream.getTracks().forEach(track => {\n          stream.removeTrack(track);\n          track.stop();\n        });\n        stream = null;\n      }\n    }\n  }, [stopStream]);\n  react_1.default.useEffect(() => {\n    const interval = setInterval(capture, delay);\n    return () => {\n      clearInterval(interval);\n    };\n  }, []);\n  return react_1.default.createElement(react_webcam_1.default, {\n    width: width,\n    height: height,\n    ref: webcamRef,\n    screenshotFormat: \"image/jpeg\",\n    videoConstraints: videoConstraints || {\n      facingMode\n    },\n    audio: false,\n    onUserMediaError: onError\n  });\n};\n\nexports.default = BarcodeScannerComponent;","map":{"version":3,"sources":["/Users/OMarega/node_modules/react-qr-barcode-scanner/dist/BarcodeScannerComponent.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","react_1","require","library_1","react_webcam_1","BarcodeScannerComponent","onUpdate","onError","width","height","facingMode","torch","delay","videoConstraints","stopStream","webcamRef","default","useRef","capture","useCallback","_a","codeReader","BrowserMultiFormatReader","imageSrc","current","getScreenshot","decodeFromImage","undefined","then","result","catch","err","useEffect","_b","navigator","mediaDevices","getSupportedConstraints","stream","video","srcObject","track","getVideoTracks","getCapabilities","getConstraints","applyConstraints","advanced","getTracks","forEach","removeTrack","stop","interval","setInterval","clearInterval","createElement","ref","screenshotFormat","audio","onUserMediaError"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst react_1 = __importDefault(require(\"react\"));\nconst library_1 = require(\"@zxing/library\");\nconst react_webcam_1 = __importDefault(require(\"react-webcam\"));\nconst BarcodeScannerComponent = ({ onUpdate, onError, width = \"100%\", height = \"100%\", facingMode = \"environment\", torch, delay = 500, videoConstraints, stopStream, }) => {\n    const webcamRef = react_1.default.useRef(null);\n    const capture = react_1.default.useCallback(() => {\n        var _a;\n        const codeReader = new library_1.BrowserMultiFormatReader();\n        const imageSrc = (_a = webcamRef === null || webcamRef === void 0 ? void 0 : webcamRef.current) === null || _a === void 0 ? void 0 : _a.getScreenshot();\n        if (imageSrc) {\n            codeReader\n                .decodeFromImage(undefined, imageSrc)\n                .then((result) => {\n                onUpdate(null, result);\n            })\n                .catch((err) => {\n                onUpdate(err);\n            });\n        }\n    }, [onUpdate]);\n    react_1.default.useEffect(() => {\n        var _a, _b;\n        // Turn on the flashlight if prop is defined and device has the capability\n        if (typeof torch === \"boolean\" && ((_a = \n        // @ts-ignore\n        navigator === null || \n        // @ts-ignore\n        navigator === void 0 ? void 0 : \n        // @ts-ignore\n        navigator.mediaDevices) === null || _a === void 0 ? void 0 : _a.getSupportedConstraints().torch)) {\n            const stream = (_b = webcamRef === null || webcamRef === void 0 ? void 0 : webcamRef.current) === null || _b === void 0 ? void 0 : _b.video.srcObject;\n            const track = stream === null || stream === void 0 ? void 0 : stream.getVideoTracks()[0]; // get the active track of the stream\n            if (track &&\n                track.getCapabilities().torch &&\n                !track.getConstraints().torch) {\n                track\n                    .applyConstraints({\n                    advanced: [{ torch }],\n                })\n                    .catch((err) => onUpdate(err));\n            }\n        }\n    }, [torch, onUpdate]);\n    react_1.default.useEffect(() => {\n        var _a;\n        if (stopStream) {\n            let stream = (_a = webcamRef === null || webcamRef === void 0 ? void 0 : webcamRef.current) === null || _a === void 0 ? void 0 : _a.video.srcObject;\n            if (stream) {\n                stream.getTracks().forEach((track) => {\n                    stream.removeTrack(track);\n                    track.stop();\n                });\n                stream = null;\n            }\n        }\n    }, [stopStream]);\n    react_1.default.useEffect(() => {\n        const interval = setInterval(capture, delay);\n        return () => {\n            clearInterval(interval);\n        };\n    }, []);\n    return (react_1.default.createElement(react_webcam_1.default, { width: width, height: height, ref: webcamRef, screenshotFormat: \"image/jpeg\", videoConstraints: videoConstraints || {\n            facingMode,\n        }, audio: false, onUserMediaError: onError }));\n};\nexports.default = BarcodeScannerComponent;\n"]},"metadata":{},"sourceType":"script"}